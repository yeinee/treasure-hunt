<script type="text/javascript">
	$(function() {
		var fieldsCount,
		maxFieldsCount = 5,
		$addLink = $('a.add_question_btn');

	  function toggleAddLink() {
	    $addLink.toggle(fieldsCount < maxFieldsCount)
	  }

	  $(document).on('nested:fieldAdded', function() {
		  fieldsCount += 1;
		  toggleAddLink();
		});

	  $(document).on('nested:fieldRemoved', function() {
		 fieldsCount -= 1;
		 toggleAddLink();
		});

	 // count existing nested fields after page was loaded
		fieldsCount = $('form .q_field').length;
		toggleAddLink();

		$("#new_post").find(".q_field:first .remove_question_btn").remove()
	})
</script>

<h1>New post</h1>

<%= render 'form' %>

<%= link_to 'Back', posts_path %>